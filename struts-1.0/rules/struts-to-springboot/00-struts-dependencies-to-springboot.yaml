# Rules for migrating Struts dependencies to Spring Boot starters

- category: mandatory
  customVariables: []
  description: Remove Struts core dependency and add Spring Boot starters
  effort: 3
  labels:
    - konveyor.io/source=struts
    - konveyor.io/target=springboot
  links:
    - title: Spring Boot Starters
      url: https://docs.spring.io/spring-boot/docs/current/reference/html/using.html#using.build-systems.starters
  message: |
    Struts dependencies must be removed and replaced with Spring Boot starters.
    
    **Remove from pom.xml:**
    ```xml
    <!-- REMOVE all Struts dependencies -->
    <dependency>
        <groupId>org.apache.struts</groupId>
        <artifactId>struts-core</artifactId>
    </dependency>
    <dependency>
        <groupId>org.apache.struts</groupId>
        <artifactId>struts-taglib</artifactId>
    </dependency>
    <dependency>
        <groupId>org.apache.struts</groupId>
        <artifactId>struts-tiles</artifactId>
    </dependency>
    ```
    
    **Add Spring Boot parent POM:**
    ```xml
    <parent>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-parent</artifactId>
        <version>3.2.0</version>
    </parent>
    ```
    
    **Add required Spring Boot starters:**
    ```xml
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-web</artifactId>
    </dependency>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-thymeleaf</artifactId>
    </dependency>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-data-jpa</artifactId>
    </dependency>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-validation</artifactId>
    </dependency>
    ```
    
    **Update Java version** (Spring Boot 3.x requires Java 17+):
    ```xml
    <properties>
        <java.version>17</java.version>
    </properties>
    ```
  ruleID: struts-dependencies-00001
  when:
    builtin.xml:
      filepaths:
        - pom.xml
      xpath: "//dependency[groupId[contains(text(),'struts')]]"

- category: mandatory
  customVariables: []
  description: Update packaging from WAR to JAR for embedded Tomcat
  effort: 1
  labels:
    - konveyor.io/source=struts
    - konveyor.io/target=springboot
  links:
    - title: Spring Boot Packaging
      url: https://docs.spring.io/spring-boot/docs/current/reference/html/deployment.html
  message: |
    Spring Boot applications typically use JAR packaging with embedded Tomcat.
    
    **Change packaging:**
    ```xml
    <!-- From -->
    <packaging>war</packaging>
    
    <!-- To -->
    <packaging>jar</packaging>
    ```
    
    **If you must keep WAR packaging** (e.g., for traditional servlet container deployment):
    ```xml
    <packaging>war</packaging>
    
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-tomcat</artifactId>
        <scope>provided</scope>
    </dependency>
    ```
    
    **Benefits of JAR packaging:**
    - Self-contained executable
    - Embedded Tomcat server
    - Simplified deployment (`java -jar app.jar`)
    - Cloud-native friendly
  ruleID: struts-dependencies-00002
  when:
    builtin.xml:
      filepaths:
        - pom.xml
      xpath: "//packaging[text()='war']"

- category: mandatory
  customVariables: []
  description: Add Spring Boot Maven plugin
  effort: 1
  labels:
    - konveyor.io/source=struts
    - konveyor.io/target=springboot
  links:
    - title: Spring Boot Maven Plugin
      url: https://docs.spring.io/spring-boot/docs/current/maven-plugin/reference/htmlsingle/
  message: |
    Add the Spring Boot Maven plugin for building executable JARs and running the application.
    
    **Add to pom.xml:**
    ```xml
    <build>
        <plugins>
            <plugin>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-maven-plugin</artifactId>
            </plugin>
        </plugins>
    </build>
    ```
    
    **This enables:**
    - `mvn spring-boot:run` - Run the application
    - `mvn package` - Build executable JAR/WAR
    - Automatic restart during development (with devtools)
  ruleID: struts-dependencies-00003
  when:
    builtin.xml:
      filepaths:
        - pom.xml
      xpath: "//dependency[groupId[contains(text(),'struts')]]"

- category: mandatory
  customVariables: []
  description: Create Spring Boot main application class
  effort: 2
  labels:
    - konveyor.io/source=struts
    - konveyor.io/target=springboot
  links:
    - title: Spring Boot Application
      url: https://docs.spring.io/spring-boot/docs/current/reference/html/using.html#using.structuring-your-code.using-the-default-package
  message: |
    Create a main application class with `@SpringBootApplication` annotation.
    
    **Create file**: `src/main/java/com/{package}/Application.java`
    
    ```java
    package com.example;
    
    import org.springframework.boot.SpringApplication;
    import org.springframework.boot.autoconfigure.SpringBootApplication;
    
    @SpringBootApplication
    public class Application {
    
        public static void main(String[] args) {
            SpringApplication.run(Application.class, args);
        }
    }
    ```
    
    **Important:**
    - Place in root package (e.g., `com.example`)
    - `@SpringBootApplication` enables auto-configuration
    - Component scanning covers current package and sub-packages
    
    **Package structure:**
    ```
    com.example
    ├── Application.java          # Main class
    ├── controller/               # @Controller classes
    ├── service/                  # @Service classes  
    ├── repository/               # @Repository interfaces
    ├── entity/                   # @Entity classes
    └── dto/                      # DTOs
    ```
  ruleID: struts-dependencies-00004
  when:
    builtin.xml:
      filepaths:
        - pom.xml
      xpath: "//dependency[groupId[contains(text(),'struts')]]"


